# TESSEN 프로젝트 상태 공유

## 📅 현재 상태 (2025-09-09)

### 🔧 **센서 프로젝트 (펌웨어)**
- ✅ **하드웨어**: XIAO BLE nRF52840 + LSM6DSL 센서 정상 작동
- ✅ **펌웨어**: Zephyr RTOS 기반 완성
- ✅ **Bluetooth**: GATT 서비스 정상 등록
- ✅ **센서 데이터**: 100Hz로 출력 중 (20Hz로 전송)
- ✅ **Windows 연결**: 페어링 및 연결 성공
- ✅ **Bluetooth 버퍼 최적화**: ENOBUFS 오류 해결
- ✅ **전송 속도 조정**: 100Hz → 20Hz로 안정화

**최근 개선사항:**
- ✅ Bluetooth 버퍼 크기 증가 (CONFIG_BT_ATT_PREPARE_COUNT=10)
- ✅ 전송 속도 제한 (5번에 1번만 전송)
- ✅ 오류 처리 개선 (연속 10회 실패 시 비활성화)
- ✅ 데이터 크기 최적화 (14바이트 고정)

### 🐍 **Python 프로젝트 (테스트)**
- ✅ **환경 구축**: 가상환경 + 패키지 설치 완료
- ✅ **Bluetooth 연결**: TESSEN 센서 연결 성공
- ✅ **디바이스 스캔**: 정상 작동
- ✅ **GATT 서비스 확인**: 구조 파악 완료
- ✅ **센서 데이터 파싱**: 14바이트 구조로 수정 완료
- ✅ **알림 설정**: 수정된 코드로 테스트 준비 완료

**최근 개선사항:**
- ✅ 데이터 구조 수정 (33바이트 → 14바이트)
- ✅ 파싱 로직 개선 (int16 기반)
- ✅ 디버그 스크립트 업데이트
- ✅ 실시간 데이터 수신 준비 완료

## 🎯 **현재 상태**

### **✅ 해결된 문제:**
1. **Bluetooth 전송 오류 (ENOBUFS)**
   - 버퍼 크기 증가 및 전송 속도 조정으로 해결
   - 100Hz → 20Hz 전송으로 안정화

2. **데이터 구조 불일치**
   - Python 코드를 펌웨어의 실제 구조(14바이트)에 맞게 수정
   - int16 기반 파싱 로직으로 변경

3. **오류 처리 개선**
   - 연속 실패 시에만 알림 비활성화
   - 성공 시 오류 카운트 리셋

### **🔄 다음 단계:**
1. **실제 테스트**: 수정된 펌웨어와 Python 코드로 통합 테스트
2. **성능 확인**: 20Hz 전송률로 안정적인 데이터 수신 확인
3. **최적화**: 필요시 전송 속도나 버퍼 크기 추가 조정

## 📋 **다음 작업 계획**

### **1단계: 센서 상태 확인**
- [ ] 시리얼 콘솔에서 센서 데이터 출력 확인
- [ ] Bluetooth 광고 상태 확인
- [ ] GATT 서비스 등록 상태 확인

### **2단계: Python 코드 수정**
- [ ] GATT 서비스 구조 수정
- [ ] 알림 설정 로직 개선
- [ ] 센서 데이터 파싱 로직 수정

### **3단계: 통합 테스트**
- [ ] 센서 데이터 수신 테스트
- [ ] 실시간 데이터 시각화
- [ ] 안정성 테스트

## 🔗 **중요한 UUID 정보**
```
TESSEN 서비스: 12345678-1234-5678-1234-56789abcdef0
센서 데이터: 12345678-1234-5678-1234-56789abcdef1 (Notify)
설정: 12345678-1234-5678-1234-56789abcdef2 (Read/Write)
```

## 📊 **센서 데이터 구조 (실제 사용)**
```c
// 펌웨어에서 실제 사용하는 구조
int16_t data[7] = {
    accel_x * 1000,    // m/s²
    accel_y * 1000,    // m/s²
    accel_z * 1000,    // m/s²
    gyro_x * 1000,     // rad/s
    gyro_y * 1000,     // rad/s
    gyro_z * 1000,     // rad/s
    temperature * 100  // °C
};                     // 총 14 bytes (7 * int16)
```

## 📝 **변경사항 추적**

### **2025-09-09 17:00 - 통합 테스트 준비 완료**
- **센서 AI**: Bluetooth 전송 오류 해결, 데이터 구조 최적화 완료
- **Python AI**: 파싱 로직 수정, 디버깅 프로그램 업데이트 완료
- **상태**: 센서-Python 연동 완료, 통합 테스트 준비

### **2025-09-09 16:45 - Python 코드 수정**
- **변경**: 데이터 파싱 로직을 14바이트 구조로 수정
- **개선**: int16 기반 파싱으로 변경
- **파일**: `tessen_debug.py`, `tessen_bt_test.py`

### **2025-09-09 16:30 - 센서 프로젝트 개선**
- **변경**: 데이터 구조를 33바이트 → 14바이트로 최적화
- **개선**: Bluetooth 전송 속도 100Hz → 20Hz로 조정
- **해결**: ENOBUFS 오류 해결

### **2025-09-09 16:00 - 프로젝트 간 소통 시작**
- **생성**: 공유 상태 파일 시스템 구축
- **파일**: `status.md`, `debug_log.md`, `communication.md`
- **효과**: 실시간 협업 및 문제 해결

## 🔗 **관련 파일**
- **상태 파일**: `shared/status.md` (현재 파일)
- **디버그 로그**: `shared/debug_log.md`
- **소통 기록**: `shared/communication.md`
- **Python 코드**: `tessen_debug.py`, `tessen_bt_test.py`

---
**마지막 업데이트**: 2025-09-09 17:00
**상태**: Bluetooth 전송 오류 해결, Python 코드 수정 완료, 통합 테스트 준비 완료
**협업**: 센서 AI ↔ Python AI 실시간 소통 활성화
